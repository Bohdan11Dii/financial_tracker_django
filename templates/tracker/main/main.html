{% extends "base.html" %}
{% load static %}

{% block content %}
  <div class="w-full px-6 py-6 mx-auto">
    <!-- row 1 -->
    <div class="flex flex-wrap -mx-3">
      <!-- card1 -->
      <div
          class="w-full max-w-full px-3 mb-6 sm:w-1/2 sm:flex-none xl:mb-0 xl:w-1/4">
        <div
            class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
          <div class="flex-auto p-4">
            <div class="flex flex-row -mx-3">
              <div class="flex-none w-2/3 max-w-full px-3">
                <div>
                  <p
                      class="mb-0 font-sans font-semibold leading-normal text-sm">
                    Balance
                  </p>
                  <h5 class="mb-0 font-bold">
                    {{ balance }}
                  </h5>
                </div>
              </div>
              <div class="px-3 text-right basis-1/3">
                <div
                    class="inline-block w-12 h-12 text-center rounded-lg bg-gradient-to-tl from-purple-700 to-pink-500">
                  <i
                      class="ni leading-none ni-money-coins text-lg relative top-3.5 text-white"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- card2 -->
      <div
          class="w-full max-w-full px-3 mb-6 sm:w-1/2 sm:flex-none xl:mb-0 xl:w-1/4">
        <div
            class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
          <div class="flex-auto p-4">
            <div class="flex flex-row -mx-3">
              <div class="flex-none w-2/3 max-w-full px-3">
                <div>
                  <p
                      class="mb-0 font-sans font-semibold leading-normal text-sm">
                    Income
                  </p>
                  <h5 class="mb-0 font-bold">
                    {{ income_total }}
                  </h5>
                </div>
              </div>
              <div class="px-3 text-right basis-1/3">
                <div
                    class="inline-block w-12 h-12 text-center rounded-lg bg-gradient-to-tl from-purple-700 to-pink-500">
                  <i
                      class="ni leading-none ni-world text-lg relative top-3.5 text-white"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- card3 -->
      <div
          class="w-full max-w-full px-3 mb-6 sm:w-1/2 sm:flex-none xl:mb-0 xl:w-1/4">
        <div
            class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
          <div class="flex-auto p-4">
            <div class="flex flex-row -mx-3">
              <div class="flex-none w-2/3 max-w-full px-3">
                <div>
                  <p
                      class="mb-0 font-sans font-semibold leading-normal text-sm">
                    Expense
                  </p>
                  <h5 class="mb-0 font-bold">
                    {{ expense_total }}

                  </h5>
                </div>
              </div>
              <div class="px-3 text-right basis-1/3">
                <div
                    class="inline-block w-12 h-12 text-center rounded-lg bg-gradient-to-tl from-purple-700 to-pink-500">
                  <i
                      class="ni leading-none ni-paper-diploma text-lg relative top-3.5 text-white"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- card4 -->
      <div class="w-full max-w-full px-3 sm:w-1/2 sm:flex-none xl:w-1/4">
        <div
            class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
          <div class="flex-auto p-4">
            <div class="flex flex-row -mx-3">
              <div class="flex-none w-2/3 max-w-full px-3">
                <div>
                  <p
                      class="mb-0 font-sans font-semibold leading-normal text-sm">
                    Sales
                  </p>
                  <h5 class="mb-0 font-bold">
                    $103,430
                    <span
                        class="leading-normal text-sm font-weight-bolder text-lime-500"
                    >+5%</span
                    >
                  </h5>
                </div>
              </div>
              <div class="px-3 text-right basis-1/3">
                <div
                    class="inline-block w-12 h-12 text-center rounded-lg bg-gradient-to-tl from-purple-700 to-pink-500">
                  <i
                      class="ni leading-none ni-cart text-lg relative top-3.5 text-white"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- cards row 2 -->
    <div class="flex flex-wrap mt-6 -mx-3">
      <div class="w-full px-3 mb-6 lg:mb-0 lg:w-7/12 lg:flex-none">
        <div
            class="relative flex flex-col min-w-0 break-words bg-white shadow-soft-xl rounded-2xl bg-clip-border">
          <div class="flex-auto p-4">
            <div class="flex flex-wrap -mx-3">
              <div class="max-w-full px-3 lg:w-1/2 lg:flex-none">
                <div class="flex flex-col h-full p-4 bg-white rounded-2xl shadow-md">
                  <p class="text-sm text-gray-500 mb-2 uppercase tracking-wide font-semibold">
                    Greetings & Reminders
                  </p>
                  <h2 class="text-xl font-bold text-gray-800 mb-1">
                    üëã Hello, {{ user }}!
                  </h2>
                  <p class="text-gray-700 text-base mb-3">
                    üìä Your current balance is: <span class="font-semibold text-green-600">{{ balance }}</span>
                  </p>
                  <p class="text-gray-600 italic text-sm">
                    üí° Don‚Äôt forget to add a new transaction today!
                  </p>
                </div>

              </div>
              <div
                  class="max-w-full px-3 mt-12 ml-auto text-center lg:mt-0 lg:w-5/12 lg:flex-none">
                <div
                    class="h-full bg-gradient-to-tl from-purple-700 to-pink-500 rounded-xl">
                  <img
                      src="{% static 'img/shapes/waves-white.svg' %}"
                      class="absolute top-0 hidden w-1/2 h-full lg:block"
                      alt="waves"/>
                  <div
                      class="relative flex items-center justify-center h-full">
                    <img
                        class="relative z-20 w-full pt-6"
                        src="{% static 'img/illustrations/rocket-white.png' %}"
                        alt="rocket"/>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="w-full max-w-full px-3 lg:w-5/12 lg:flex-none">
        <div
            class="border-black/12.5 shadow-soft-xl relative flex h-full min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border p-4">
          <div
              class="relative h-full overflow-hidden bg-cover rounded-xl"
              style="background-image: url('{% static 'img/ivancik.jpg' %}')">
                <span
                    class="absolute top-0 left-0 w-full h-full bg-center bg-cover bg-gradient-to-tl from-gray-900 to-slate-800 opacity-80"></span>
            <div class="relative z-10 flex flex-col flex-auto h-full p-4 bg-gray-800 rounded-lg">
              <h5 class="pt-2 mb-6 font-bold text-white text-xl">
                Quick access buttons
              </h5>
              <div class="flex flex-wrap gap-4">
                <a href="{% url 'tracker:category-create' %}">
                  <button
                      type="button"
                      class="px-4 py-2 border border-blue-500 text-blue-500 rounded-md hover:bg-blue-500 hover:text-white transition"
                  >
                    Create new category
                  </button>
                </a>
                <a href="{% url 'tracker:currency-create' %}">
                  <button
                      type="button"
                      class="px-4 py-2 border border-purple-500 text-purple-500 rounded-md hover:bg-purple-500 hover:text-white transition"
                  >
                    Create new currency
                  </button>
                </a>
                <a href="{% url 'tracker:transaction-create' %}">
                  <button
                      type="button"
                      class="px-4 py-2 border border-green-500 text-green-500 rounded-md hover:bg-green-500 hover:text-white transition"
                  >
                    Create new transaction
                  </button>
                </a>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- cards row 3 -->

    <div class="flex flex-wrap mt-6 -mx-3">
      <div
          class="w-full max-w-full px-3 mt-0 mb-6 lg:mb-0 lg:w-5/12 lg:flex-none">
        <div
            class="border-black/12.5 shadow-soft-xl relative z-20 flex min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
          <div class="flex-auto p-4">

            <div id="chartContainer" style="height: 370px; width: 100%;"></div>

            <h6 class="mt-6 mb-0 ml-2">Active Currencies</h6>

            <div class="w-full px-6 mx-auto max-w-screen-2xl rounded-xl">
              <div class="flex flex-wrap mt-0 -mx-3">
                {% for cs in currency_sums %}
                  <div class="flex-none w-1/4 max-w-full py-4 pl-0 pr-3 mt-0">
                    <div class="flex mb-2">
                      <div
                          class="flex items-center justify-center w-5 h-5 mr-2 text-center bg-center rounded fill-current shadow-soft-2xl bg-gradient-to-tl from-purple-700 to-pink-500 text-neutral-900">
                        <svg
                            width="10px"
                            height="10px"
                            viewBox="0 0 40 44"
                            version="1.1"
                            xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink">
                          <title>document</title>
                          <g
                              stroke="none"
                              stroke-width="1"
                              fill="none"
                              fill-rule="evenodd">
                            <g
                                transform="translate(-1870.000000, -591.000000)"
                                fill="#FFFFFF"
                                fill-rule="nonzero">
                              <g
                                  transform="translate(1716.000000, 291.000000)">
                                <g
                                    transform="translate(154.000000, 300.000000)">
                                  <path
                                      class="color-background"
                                      d="M40,40 L36.3636364,40 L36.3636364,3.63636364 L5.45454545,3.63636364 L5.45454545,0 L38.1818182,0 C39.1854545,0 40,0.814545455 40,1.81818182 L40,40 Z"
                                      opacity="0.603585379"></path>
                                  <path
                                      class="color-background"
                                      d="M30.9090909,7.27272727 L1.81818182,7.27272727 C0.814545455,7.27272727 0,8.08727273 0,9.09090909 L0,41.8181818 C0,42.8218182 0.814545455,43.6363636 1.81818182,43.6363636 L30.9090909,43.6363636 C31.9127273,43.6363636 32.7272727,42.8218182 32.7272727,41.8181818 L32.7272727,9.09090909 C32.7272727,8.08727273 31.9127273,7.27272727 30.9090909,7.27272727 Z M18.1818182,34.5454545 L7.27272727,34.5454545 L7.27272727,30.9090909 L18.1818182,30.9090909 L18.1818182,34.5454545 Z M25.4545455,27.2727273 L7.27272727,27.2727273 L7.27272727,23.6363636 L25.4545455,23.6363636 L25.4545455,27.2727273 Z M25.4545455,20 L7.27272727,20 L7.27272727,16.3636364 L25.4545455,16.3636364 L25.4545455,20 Z"></path>
                                </g>
                              </g>
                            </g>
                          </g>
                        </svg>
                      </div>
                      <div class="currency-block">
                        <p data-currency="{{ cs.currency }}">{{ cs.currency }}</p>
                        <h4 data-amount="{{ cs.amount }}">{{ cs.amount }}</h4>
                      </div>

                    </div>
                    <div
                        class="text-xs h-0.75 flex w-3/4 overflow-visible rounded-lg bg-gray-200">
                    </div>
                  </div>

                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="w-full max-w-full px-3 mt-0 lg:w-7/12 lg:flex-none">
        <div
            class="border-black/12.5 shadow-soft-xl relative z-20 flex min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
          <div
              class="border-black/12.5 mb-0 rounded-t-2xl border-b-0 border-solid bg-white p-6 pb-0">
            <h6>Sales overview</h6>
            <p class="leading-normal text-sm">
              <i class="fa fa-arrow-up text-lime-500"></i>
              <span class="font-semibold">4% more</span> in 2021
            </p>
          </div>
          <div class="flex-auto p-4">
            <div>
              <canvas
                  id="chart-line"
                  data-labels="{{ chart_labels|join:',' }}"
                  data-income="{{ chart_income|join:',' }}"
                  data-expense="{{ chart_expense|join:',' }}">
              </canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- cards row 4 -->

    <div class="flex flex-wrap my-6 -mx-3">
      <!-- card 1 -->

      <div
          class="w-full max-w-full px-3 mt-0 mb-6 md:mb-0 md:w-1/2 md:flex-none lg:w-2/3 lg:flex-none">
        <div
            class="border-black/12.5 shadow-soft-xl relative flex min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
          <div
              class="border-black/12.5 mb-0 rounded-t-2xl border-b-0 border-solid bg-white p-6 pb-0">
            <div class="flex flex-wrap mt-0 -mx-3">
              <div
                  class="flex-none w-7/12 max-w-full px-3 mt-0 lg:w-1/2 lg:flex-none">
                <h6>Recent transactions</h6>
                <form method="get" class="mb-4">
                  <label for="month" class="mr-2 font-semibold">Filter by month:</label>
                  <select name="month" id="month" class="border rounded px-3 py-1">
                    <option value="">All</option>
                    {% for month_num, month_name in months %}
                      <option value="{{ month_num }}" {% if month_num == selected_month %}selected{% endif %}>
                        {{ month_name }}
                      </option>
                    {% endfor %}
                  </select>
                  <button type="submit" class="ml-2 px-4 py-1 btn btn-outline-secondary">Show</button>
                </form>
              </div>
              {#          #}


            </div>
          </div>
          <div class="flex-auto p-6 px-0 pb-2">
            <div class="overflow-x-auto">
              <table
                  class="table-custom items-center mb-0 text-slate-500">
                <thead class="align-bottom">
                <tr>
                  <th
                      class="px-6 py-3 font-bold tracking-normal text-left uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">
                    Transaction name
                  </th>
                  <th
                      class="px-6 py-3 pl-2 font-bold tracking-normal text-left uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">
                    The amount
                  </th>
                  <th
                      class="px-6 py-3 font-bold tracking-normal text-center uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">
                    Category
                  </th>
                  <th
                      class="px-6 py-3 font-bold tracking-normal text-center uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">
                    Transaction type
                  </th>
                  <th
                      class="px-6 py-3 font-bold tracking-normal text-center uppercase align-middle bg-transparent border-b letter border-b-solid text-xxs whitespace-nowrap border-b-gray-200 text-slate-400 opacity-70">
                    Date
                  </th>

                </tr>
                </thead>
                <tbody>
                {% for item in recent %}
                  <tr>
                    <td
                        class="p-2 align-middle bg-transparent border-b whitespace-nowrap">
                      <div class="flex px-2 py-1">
                        <div>
                          <img
                              src="{% static 'img/small-logos/logo-xd.svg' %}"
                              class="inline-flex items-center justify-center mr-4 text-white transition-all duration-200 ease-soft-in-out text-sm h-9 w-9 rounded-xl"
                              alt="xd"/>
                        </div>
                        <div class="flex flex-col justify-center">
                          <h6 class="mb-0 leading-normal text-sm">
                            {{ item.name }}
                          </h6>
                        </div>
                      </div>
                    </td>

                    <td
                        class="p-2 leading-normal text-center align-middle bg-transparent border-b text-sm whitespace-nowrap">
                          <span class="font-semibold leading-tight text-xs">
                           {{ item.amount }}
                          </span>
                    </td>
                    <td
                        class="p-2 align-middle bg-transparent border-b whitespace-nowrap">
                                <span class="font-semibold leading-tight text-xs">
                           {{ item.category.name }}
                          </span>
                    </td>
                    <td class="p-2 align-middle bg-transparent border-b whitespace-nowrap">
                      {% if item.type == "income" %}
                        <span
                            class="font-semibold leading-tight text-xs text-success px-2 py-1 rounded-lg">
                            Income
                          </span>
                      {% elif item.type == "expense" %}
                        <span class="font-semibold leading-tight text-xs text-red-600 bg-red-100 px-2 py-1 rounded-lg">
      Expense
    </span>
                      {% else %}
                        <span class="font-semibold leading-tight text-xs text-gray-600">
      {{ item.type }}
    </span>
                      {% endif %}
                    </td>

                    <td
                        class="p-2 align-middle bg-transparent border-b whitespace-nowrap">
                                <span class="font-semibold leading-tight text-xs">
                           {{ item.date }}
                          </span>
                    </td>
                  </tr>
                {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- card 2 -->

      <div
          class="w-full max-w-full px-3 md:w-1/2 md:flex-none lg:w-1/3 lg:flex-none">
        <div
            class="border-black/12.5 shadow-soft-xl relative flex h-full min-w-0 flex-col break-words rounded-2xl border-0 border-solid bg-white bg-clip-border">
          <div
              class="border-black/12.5 mb-0 rounded-t-2xl border-b-0 border-solid bg-white p-6 pb-0">
            <h6>Cost leaders</h6>
          </div>
          <form method="get" class="inline-block">
            <select name="order" onchange="this.form.submit()"
                    class="form-select custom-select" aria-label="Large select example">
              <option value="desc" {% if request.GET.order == 'desc' %}selected{% endif %}>–ù–∞–π–±—ñ–ª—å—à—ñ —Å–ø–æ—á–∞—Ç–∫—É</option>
              <option value="asc" {% if request.GET.order == 'asc' %}selected{% endif %}>–ù–∞–π–º–µ–Ω—à—ñ —Å–ø–æ—á–∞—Ç–∫—É</option>
            </select>
          </form>
          <div class="flex-auto p-4">
            <div
                class="relative before:absolute before:top-0 before:left-4 before:h-full before:border-r-2 before:border-slate-100 before:content-['']">

              {% for item in top_expenses %}
                <div class="relative mb-4 after:clear-both after:table after:content-['']">
                  <span
                      class="w-6.5 h-6.5 text-base absolute left-4 z-10 inline-flex -translate-x-1/2 items-center justify-center rounded-full bg-white text-center font-semibold">
                   <i class="fa-solid fa-fire text-red-600"></i>
                  </span>
                  <div class="ml-11.252 pt-1.4 relative -top-1.5 w-auto">
                    <h6 class="mb-0 font-semibold leading-normal text-sm text-slate-700">
                      {{ item.name }}: {{ item.total_expense|floatformat:2 }} {{ item.currency_symbol }}
                    </h6>
                    {% if item.last_date %}
                      <p class="mt-1 mb-0 font-semibold leading-tight text-xs text-slate-400">
                        {{ item.last_date }}
                      </p>
                    {% endif %}
                  </div>
                </div>
              {% endfor %}

            </div>
          </div>

        </div>
      </div>
    </div>

    <footer class="pt-4">
      <div class="w-full px-6 mx-auto">
        <div class="flex flex-wrap items-center -mx-3 lg:justify-between">
          <div
              class="w-full max-w-full px-3 mt-0 mb-6 shrink-0 lg:mb-0 lg:w-1/2 lg:flex-none">
            <div
                class="leading-normal text-center text-sm text-slate-500 lg:text-left">
              ¬©
              <script>
                  document.write(new Date().getFullYear() + ",");
              </script>
              made with <i class="fa fa-heart"></i> by
              <a
                  href="https://www.creative-tim.com"
                  class="font-semibold text-slate-700"
                  target="_blank"
              >Creative Tim</a
              >
              for a better web.
              <span class="w-full"> Distributed by ‚ù§Ô∏è ThemeWagon </span>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>




{% endblock %}